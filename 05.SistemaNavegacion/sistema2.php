<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Capitales de Europa</title>
	<link rel="stylesheet" href="estilos.css">
</head>
<body>


  <div id ="principal">   
    <div>
      <table width="1330" border="1">
        <tr>
          <td  height="55" bgcolor="#00FFFF"><p align="center" id="Titulo">Las Capitales de Europa</p></td>
      </tr>
  </table>
  <p>&nbsp;</p>
  <form id="form1" name="form1" method="post" action="sistema.php">
    <p>Buscar Imágen por Etiquetas:
      <input type="text" name="texto" id="texto" />
      <input type="submit" name="buscar" id="buscar" value="Buscar" />
  </p>
  <p>&nbsp;</p>

</form>

</div>

<div id ="contenedor">
    <table align = 'center'  border="1">
      <tr>
        <td width="200">
          <table border="1">
          <tr> <td id='Titulo2'> Capitales </td> </tr>
          <tr> <td>
          <div id='capital'>
            <p> <a href = "sistema.php?etiqueta=tirana albania" > Tirana, Albania</a> </p> 
            <p> <a href = "sistema.php?etiqueta=amsterdam holanda" > Ámsterdam, Holanda</a> </p> 
            <p> <a href = "sistema.php?etiqueta=andorralavieja andorra" > Andorra la vieja, Andorra</a> </p> 
            <p> <a href = "sistema.php?etiqueta=ankara turquia" > Ankara, Turquía</a> </p> 
            <p> <a href = "sistema.php?etiqueta=astana kazajistan" > Astaná, Kazajistán</a> </p> 
            <p> <a href = "sistema.php?etiqueta=atenas grecia" > Atenas, Grecia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=baku azerbaiyan" > Bakú, Azerbaiyán</a> </p> 
            <p> <a href = "sistema.php?etiqueta=belgrado serbia" > Belgrado, Serbia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=berlin alemania" > Berlín, Alemania</a> </p> 
            <p> <a href = "sistema.php?etiqueta=berna suiza" > Berna, Suiza</a> </p> 
            <p> <a href = "sistema.php?etiqueta=bratislava eslovaquia" > Bratislava, Eslovaquia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=bruselas belgica" > Bruselas, Bélgica</a> </p> 
            <p> <a href = "sistema.php?etiqueta=bucarest rumania" > Bucarest, Rumania</a> </p> 
            <p> <a href = "sistema.php?etiqueta=budapest hungria" > Budapest, Hungría</a> </p> 
            <p> <a href = "sistema.php?etiqueta=chisinau moldavia" > Chisinau, Moldavia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=vaticano ciudaddelvaticano" > Ciudad del Vaticano, Vaticano</a> </p> 
            <p> <a href = "sistema.php?etiqueta=copenhague dinamarca" > Copenhague, Dinamarca</a> </p> 
            <p> <a href = "sistema.php?etiqueta=dublin irlanda" > Dublín, Irlanda</a> </p> 
            <p> <a href = "sistema.php?etiqueta=erevan armenia" > Ereván, Armenia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=estocolmo suecia" > Estocolmo, Suecia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=helsinki finlandia" > Helsinki, Finlandia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=kiev ucrania" > Kiev, Ucrania</a> </p> 
            <p> <a href = "sistema.php?etiqueta=lavaleta malta" > La Valeta, Malta</a> </p> 
            <p> <a href = "sistema.php?etiqueta=lisboa portugal" > Lisboa, Portugal</a> </p> 
            <p> <a href = "sistema.php?etiqueta=liubliana eslovenia" > Liubliana, Eslovenia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=londres inglaterra" > Londres, Inglaterra</a> </p> 
            <p> <a href = "sistema.php?etiqueta=luxemburgo" > Luxemburgo, Luxemburgo</a> </p> 
            <p> <a href = "sistema.php?etiqueta=madrid espanha" > Madrid, España</a> </p> 
            <p> <a href = "sistema.php?etiqueta=minsk bielorrusia" > Minsk, Bielorrusia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=monaco" > Mónaco, Mónaco</a> </p> 
            <p> <a href = "sistema.php?etiqueta=moscu rusia" > Moscú, Rusia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=nicosia chipre" > Nicosia, Chipre</a> </p> 
            <p> <a href = "sistema.php?etiqueta=oslo nosruega" > Oslo, Noruega</a> </p> 
            <p> <a href = "sistema.php?etiqueta=paris francia" > París, Francia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=podgorica montenegro" > Podgorica, Montenegro</a> </p> 
            <p> <a href = "sistema.php?etiqueta=praga republicacheca" > Praga, República Checa</a> </p> 
            <p> <a href = "sistema.php?etiqueta=reikiavik islandia" > Reikiavik, Islandia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=riga letonia" > Riga, Letonia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=roma italia" > Roma, Italia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=sanmarino" > San Marino, San Marino</a> </p> 
            <p> <a href = "sistema.php?etiqueta=sarajevo bosnia" > Sarajevo, Bosnia y Herzegovina</a> </p> 
            <p> <a href = "sistema.php?etiqueta=skopie macedonia" > Skopie, Macedonia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=sofia bulgaria" > Sofía, Bulgaria</a> </p> 
            <p> <a href = "sistema.php?etiqueta=tallin estonia" > Tallin, Estonia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=tiflis georgia" > Tiflis, Georgia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=vaduz liechtenstein" > Vaduz, Liechtenstein</a> </p> 
            <p> <a href = "sistema.php?etiqueta=varsovia polonia" > Varsovia, Polonia</a> </p> 
            <p> <a href = "sistema.php?etiqueta=viena austria" > Viena, Austria</a> </p> 
            <p> <a href = "sistema.php?etiqueta=vilna lituania" > Vilna, Lituania</a> </p> 
            <p> <a href = "sistema.php?etiqueta=zagreb croacia" > Zagreb, Croacia</a> </p> </div>
            </td> </tr> </table>
        </td>
         <td width="900">
         <div id='fotos' align ='center'>
         <table border='1' align='center'> <tr height ='600'> <td>             
         
                  <?php
                 function ejecutarPython($archivoPython, $consulta){
                      $directorio = getcwd();
                      $command = escapeshellcmd("$directorio/$archivoPython $consulta");
                      $output = shell_exec($command);    
                      return $output;             
                  }
                
                  $imagen = $_GET['imagen'];
                  $consulta = $_GET['etiqueta'];
                  $archivoPython = 'recuperarImagenes.py';
                  $resultados = ejecutarPython($archivoPython, $consulta);
                  $imagenes = explode(' ',$resultados);  
                  $cantidad = count($imagenes);
                  if ($cantidad == 1){
                     $imagenSiguiente=$imagenes[0];
                     $imagenAnterior = $imagenes[0]; 
                     }
                     else{  
                     $encontrado=False;
                     $i=0;
                     while ($i<$cantidad and $encontrado==False){
                         if ($imagenes[$i] == $imagen) {           
                                 if ($i==0){
                                $imagenAnterior = $imagenes[$cantidad-1];
                                $imagenSiguiente = $imagenes[$i+1];
                                }                             
                                else{$imagenSiguiente = $imagenes[$i+1];
                                     $imagenAnterior = $imagenes[$i-1];}
                          $encontrado=True;
                          }else{$i=$i+1;}                      
                       }         
                      if ($encontrado==False){          
                              $i--;
                              $imagenAnterior = $imagenes[$i-1];
                              $imagenSiguiente = $imagenes[0];
                             }
                       }           
                     echo "<div class='imagen'> <img  src='Fotos/$imagen.jpg'> </div>"; 
                     echo "</td> </tr>";
                     $i++;
                     echo "<tr> <td align= 'right' class='iconos'> $i de $cantidad <a href = 'sistema2.php?etiqueta=$consulta&imagen=$imagenAnterior'><img  src='Fotos/atras.png'></a>    <a href = 'sistema2.php?etiqueta=$consulta&imagen=$imagenSiguiente'> <img  src='Fotos/siguiente.png'> </a>    </td> </tr>";            
                  $archivoPython = 'recuperarTitulo.py';
                  $titulo = ejecutarPython($archivoPython, $imagen);
                  $archivoPython = 'recuperarEtiquetas.py';
                  $datosEtiquetas = ejecutarPython($archivoPython, $imagen);
                  $etiquetas = explode(' ',$datosEtiquetas);
           
         echo "<tr> <td> <p id='title'> Titulo: $titulo </p></td> </tr>";
         echo "<tr> <td> Etiquetas: ";
         for ($i=0;$i<count($etiquetas);$i++){
             echo "<a href = 'sistema.php?etiqueta=$etiquetas[$i]'> $etiquetas[$i] </a>  ";
            }
         echo "</td> </tr></table>";
          ?>
         </div>
         <td with = "200"> 
         <table border="1">
          <tr> <td id='Titulo2'> Etiquetas Relacionadas </td> </tr>
         <tr> <td>
          <div  id= 'relacionadas'>
               <?php
                  $consulta = $_GET['etiqueta'];
                  $archivoPython = 'recuperarEtiquetasRelacionadas.py';
                  $resultados = ejecutarPython($archivoPython, $consulta);
                      $etiquetas = explode(' ',$resultados);    
                      for ($i=0; $i<count($etiquetas);$i++){ 
                       echo "<p> <a href = 'sistema.php?etiqueta=$etiquetas[$i]'> $etiquetas[$i] </a> </p>"; 
                      }
                
                  ?>
               </div>
         </td>  </tr> </table>
         </tr>
</table>

</div>
</body>
</html>



